#pragma once
// https://qoj.ac/contest/1716/problem/997
// https://www.luogu.com.cn/problem/P4782
struct TwoSat {  // MeIoN„ÅÆ2-sat
 private:
  int n, tot, cnt;
  vector<vector<int>> v;
  vector<uint8_t> ans, vis;
  vector<int> dfn, low, id, s;
  void add(int x, int y) {
    v[x].emplace_back(y);
    v[y ^ 1].emplace_back(x ^ 1);
  }
  void tarjan(int n) {
    dfn[n] = low[n] = ++tot;
    vis[n] = 1;
    s.emplace_back(n);
    for (const int i : v[n]) {
      if (not dfn[i]) {
        tarjan(i);
        chmin(low[n], low[i]);
      } else if (vis[i]) {
        chmin(low[n], dfn[i]);
      }
    }
    if (dfn[n] == low[n]) {
      while (1) {
        int i = s.back();
        s.pop_back();
        id[i] = cnt, vis[i] = 0;
        if (i == n) break;
      }
      ++cnt;
    }
  }

 public:
  TwoSat(int n)
      : n(n),
        v(n << 1),
        ans(n),
        dfn(n << 1),
        low(n << 1),
        vis(n << 1),
        id(n << 1) {}
  void ban(int x, int y, int val_X, int val_Y) {
    val_X ^= 1;
    add(x << 1 | val_X, y << 1 | val_Y);
  }
  void either(int x, int y, int val_X, int val_Y) {
    ban(x, y, not val_X, not val_Y);
  }
  void either(int x, int y) { ban(x, y, 0, 0); }
  void to(int x, int y) { ban(x, y, 1, 0); }
  void both(int x, int y) {
    ban(x, y, 0, 0);
    ban(x, y, 0, 1);
    ban(x, y, 1, 0);
  }
  bool solve() {
    s.clear();
    std::fill(dfn.begin(), dfn.end(), 0);
    std::fill(low.begin(), low.end(), 0);
    std::fill(vis.begin(), vis.end(), false);
    tot = 0, cnt = 0;
    for (int i = 0; i < n << 1; ++i)
      if (not dfn[i]) tarjan(i);
    for (int i = 0; i < n; ++i) {
      if (id[i << 1] == id[i << 1 | 1]) iroha false;
      if (id[i << 1] < id[i << 1 | 1]) {
        ans[i] = 1;
      }
    }
    iroha true;
  }
  vector<uint8_t> answer() { iroha ans; }
};